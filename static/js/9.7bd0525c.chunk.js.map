{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","Image","h2","img","A","a","Input","input","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","height","setWidth","setHeight","serverFile","attributes","url","widthStr","heightStr","bundleCopy","document","createElement","value","style","position","left","body","appendChild","focus","select","execCommand","message","success","error","removeChild","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","warning","test","type","size","upload","then","catch","err","spinning","isUploading","tip","className","InboxOutlined","title","layout","bordered","Item","label","span","target","href","onClick","bind","filename","src","row","ref","onChange","current","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"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","file":"static/js/9.7bd0525c.chunk.js","sourcesContent":["import React, { useRef } from \"react\";\r\nimport { useStores } from '../stores';\r\nimport { observer, useLocalStore } from 'mobx-react';\r\nimport { Upload, message, Spin, Descriptions, Button  } from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components'\r\n\r\nconst { Dragger } = Upload;\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  margin-bottom: 30px;\r\n`\r\nconst H2 = styled.h2`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`\r\nconst A = styled.a`\r\n  margin-top: 6px;\r\n`\r\nconst Input = styled.input`\r\n@media (min-width: 768px){\r\n  margin-left: 6px;\r\n}\r\n@media (max-width: 768px){\r\n  display: block;\r\n  margin: 10px 0;\r\n}\r\n`\r\n\r\nconst Component = observer(()=>{\r\n  const { ImageStore, UserStore } = useStores()\r\n  const ref1 = useRef()\r\n  const ref2 = useRef()\r\n  const store = useLocalStore(()=>({\r\n    width: null,\r\n    height: null,\r\n    setWidth(width){\r\n      store.width = width\r\n    },\r\n    setHeight(height){\r\n      store.height = height\r\n    },\r\n    get widthStr(){\r\n      return store.width? `/w/${store.width}`:''\r\n    },\r\n    get heightStr(){\r\n      return store.height? `/h/${store.height}`:''\r\n    },\r\n    get fullStr(){\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n  }))\r\n  const bundleCopy = (url) => {\r\n    let input = document.createElement('textarea')\r\n    input.value = url\r\n    input.style.position = 'absolute';\r\n    input.style.left = '-9999px';\r\n    document.body.appendChild(input);\r\n    input.focus()\r\n    input.select()\r\n    if(document.execCommand('Copy')){\r\n      document.execCommand('Copy')\r\n      message.success('复制成功')\r\n    }else{\r\n      message.error('复制失败,请通过在线预览手动复制')\r\n      \r\n    }\r\n    document.body.removeChild(input);\r\n\r\n  }\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      ImageStore.setFile(file)\r\n      ImageStore.setFilename(file.name)\r\n\r\n      if(UserStore.currentUser === null){\r\n        message.warning('请先登录在上传！')\r\n        return false\r\n      }\r\n\r\n      if(!/(jpg$)|(svg$)|(jpeg$)|(png$)|(gif$)/ig.test(file.type)){\r\n        message.error('仅可上传jpg、svg、jpeg、png和gif类型的图片！')\r\n        return false\r\n      }\r\n\r\n      if(file.size > 1024*1024){\r\n        message.error('图片不能超过1M！')\r\n        return false\r\n      }\r\n\r\n      ImageStore.upload()\r\n        .then((serverFile)=>{\r\n\r\n        }).catch(err=>{\r\n          \r\n        })\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const bindWidth = () => {\r\n    store.setWidth(ref1.current.value)\r\n  }\r\n  const bindHeight = () => {\r\n    store.setHeight(ref2.current.value)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Spin spinning={ImageStore.isUploading} tip=\"加载中...\">\r\n      <Dragger {...props} tip=\"上传中...\">\r\n        <p className=\"ant-upload-drag-icon\">\r\n          <InboxOutlined />\r\n        </p>\r\n        <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\r\n        <p className=\"ant-upload-hint\">\r\n          仅支持.png/.jpg/.svg/.jpeg/.gif格式的图片, 图片最大1M\r\n        </p>\r\n      </Dragger>\r\n      </Spin>\r\n      <div>\r\n        {\r\n          ImageStore.serverFile ? \r\n            <Result>\r\n              <Descriptions title=\"上传结果\" layout=\"vertical\" bordered size='middle'>\r\n                <Descriptions.Item label=\"完整路径\" span={3}>\r\n                  <a target='_blank' href={ ImageStore.serverFile.attributes.url.attributes.url }><Button type='link'>在线预览</Button></a>\r\n                  <Button type=\"dashed\" onClick={bundleCopy.bind(null, ImageStore.serverFile.attributes.url.attributes.url)}>复制链接</Button>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"文件名\" span={3}>{ ImageStore.serverFile.attributes.filename }</Descriptions.Item>\r\n                <Descriptions.Item label=\"图片预览\" span={3}><Image src={ ImageStore.serverFile.attributes.url.attributes.url } /></Descriptions.Item>\r\n                <Descriptions.Item label=\"更多尺寸\" span={3} row={2}><input ref={ref1} onChange={bindWidth} placeholder='最大宽度（可选）' />\r\n                      <Input ref={ref2} onChange={bindHeight} placeholder='最大高度（可选）'  />\r\n                      <A target='_blank' href={ store.fullStr }><Button type='link'>在线预览</Button></A>\r\n                      <Button type=\"dashed\" onClick={bundleCopy.bind(null, store.fullStr)}>复制链接</Button>\r\n                </Descriptions.Item>\r\n              </Descriptions>\r\n            </Result> : null\r\n        }\r\n         \r\n      </div>\r\n    </div>\r\n  )\r\n})\r\n\r\nexport default Component","import React from 'react';\r\nimport { useStores } from '../stores';\r\nimport { observer } from 'mobx-react';\r\nimport styled from \"styled-components\";\r\n\r\nconst Tips = styled.div`\r\n  background-color: orange;\r\n  padding: 10px 12px;\r\n  margin-bottom: 30px;\r\n  font-size: 14px;\r\n  color: #fff;\r\n`\r\nconst Component= observer(( {children} )=>{\r\n  const {UserStore} = useStores()\r\n  return (\r\n    <>\r\n      {\r\n        UserStore.currentUser ?  null : <Tips>{children}</Tips>\r\n      }\r\n    </>\r\n  )\r\n})\r\n\r\nexport default Component","import React from \"react\";\r\nimport Uploader from \"../components/Uploader\";\r\nimport Tips from \"../components/Tips\";\r\n\r\nfunction Home(){\r\n  return (\r\n    <>\r\n      <Tips>请先登录！</Tips>\r\n      <Uploader />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Home"],"sourceRoot":""}