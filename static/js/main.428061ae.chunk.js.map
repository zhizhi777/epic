{"version":3,"sources":["epic.png","media.js","components/Header.js","components/Footer.js","components/Loading.js","App.js","reportWebVitals.js","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["size","tablet","laptop","desktop","mobile","Header","styled","header","HeaderBox","div","Logo","img","StyledLink","NavLink","PhoneLink","IconBox","Icon","Usertit","Login","StyledButton","Button","Component","observer","useStores","UserStore","AuthStore","history","useHistory","handleLogOut","logOut","handleLogIn","push","handleRegister","click","handleToggle","collapse","document","querySelector","colbox","style","height","offsetHeight","window","screen","width","src","Epic","to","activeClassName","exact","currentUser","attributes","username","type","onClick","className","Footer","footer","Loading","Home","React","lazy","History","About","Register","App","fallback","path","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","error","logIn","current","Uploader","file","filename","image","Object","avFile","File","set","save","serverFile","page","limit","query","Query","include","equalTo","skip","descending","find","results","catch","err","fileId","createWithoutData","destroy","result","makeAutoObservable","this","pullUser","observable","action","newList","list","concat","isLoading","append","length","hasMore","message","finally","success","filter","item","id","isUploading","values","resetUser","code","HistoryStore","reset","ImageStore","context","createContext","stores","useContext"],"mappings":"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","file":"static/js/main.428061ae.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/epic.d35e1462.png\";","\r\nconst size = {\r\n  tablet: '768px',\r\n  laptop: '1024px',\r\n  desktop: '1440px'\r\n}\r\n\r\nconst device = {\r\n  mobile: `(max-width: ${size.mobile})`,\r\n  tablet: `(max-width: ${size.tablet})`,\r\n  laptop: `(max-width: ${size.laptop})`,\r\n  desktop: `(max-width: ${size.desktop})`\r\n};\r\n\r\nexport default device","import React, {useState} from \"react\";\r\nimport Epic from \"../epic.png\";\r\nimport { NavLink, useHistory } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport { Button } from 'antd';\r\nimport { useStores } from '../stores';\r\nimport { observer } from \"mobx-react\";\r\nimport device from '../media'\r\n\r\nconst Header = styled.header`\r\n  background-color: rgba(0,0,0,0.1);\r\n  color: #fff;\r\n`\r\nconst HeaderBox = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin: 0 auto;\r\n  padding: 10px;\r\n  max-width: 68%;\r\n  \r\n  @media (max-width: 1440px){ \r\n    max-width: 72%;\r\n  }\r\n  @media (max-width: 1024px) { \r\n    max-width: 84%;\r\n  }\r\n  @media (max-width: 767px) { \r\n    max-width: 100%;\r\n    display: block;\r\n  }\r\n`\r\n\r\nconst Logo = styled.img`\r\n  height: 30px;\r\n`\r\nconst StyledLink = styled(NavLink)`\r\n  color: #fff;\r\n  margin-left: 20px;\r\n  font-size: 14px;\r\n\r\n  &.active{\r\n    color:#1890ff;\r\n  }\r\n\r\n`\r\nconst PhoneLink = styled(NavLink)`\r\n  display: block;\r\n\r\n`\r\nconst IconBox =styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n`\r\nconst Icon = styled.div`\r\n  margin-left: auto;\r\n  padding:0 4px;\r\n  color: rgba(255,255,255,.8);\r\n  border: 1px solid rgba(255,255,255,.1);\r\n`\r\nconst Usertit = styled.div`\r\n  margin-left: auto;\r\n  padding:0 4px;\r\n  color: rgba(255,255,255,.9);\r\n`\r\nconst Login = styled.div`\r\n  @media (min-width: 767px) { \r\n    margin-left: auto;\r\n  }\r\n`\r\nconst StyledButton = styled(Button)`\r\n  margin-left: 10px;\r\n\r\n`\r\n\r\nconst Component = observer(() => {\r\n  const { UserStore, AuthStore } = useStores()\r\n  const history = useHistory()\r\n  const handleLogOut = () => {\r\n    AuthStore.logOut()\r\n  }\r\n  const handleLogIn = () => {\r\n    history.push('/login')\r\n  }\r\n  const handleRegister = () => {\r\n    history.push('/register')\r\n  }\r\n  let click = true\r\n  \r\n  const handleToggle =() => {\r\n    let collapse = document.querySelector('.collapse')\r\n  let colbox = document.querySelector('.colbox')\r\n    if(click){\r\n      colbox.style.height = collapse.offsetHeight + 50 + 'px'\r\n      click = false\r\n    }else{\r\n      colbox.style.height =  50 + 'px'\r\n      click = true\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Header>\r\n      {\r\n       window.screen.width >= 768 ? \r\n        <HeaderBox>\r\n        <Logo src={Epic} />\r\n        <nav>\r\n          <StyledLink to='/' activeClassName='active' exact>首页</StyledLink>\r\n          <StyledLink to='/history' activeClassName='active'>上传历史</StyledLink>\r\n          <StyledLink to='/about' activeClassName='active'>关于我</StyledLink>\r\n        </nav>\r\n        <Login>\r\n          {\r\n            UserStore.currentUser ? <>\r\n              { UserStore.currentUser.attributes.username }\r\n              <StyledButton type=\"primary\" onClick={handleLogOut}>注销</StyledButton>\r\n            </>:\r\n            <>\r\n              <StyledButton type=\"primary\" onClick={handleLogIn}>登录</StyledButton>\r\n              <StyledButton type=\"primary\" onClick={handleRegister}>注册</StyledButton>\r\n            </>\r\n          }\r\n        </Login>\r\n        </HeaderBox> : <HeaderBox className='colbox'>\r\n          <IconBox>\r\n            <Logo src={Epic} />\r\n            {\r\n              UserStore.currentUser ? <>\r\n                <Usertit>{ UserStore.currentUser.attributes.username }</Usertit>\r\n              </>:<></>\r\n            }\r\n            <Icon onClick={handleToggle}>三</Icon>\r\n          </IconBox>\r\n          <nav className = 'collapse' onClick={handleToggle}>\r\n            <PhoneLink to='/' exact>首页</PhoneLink>\r\n            <PhoneLink to='/history'>上传历史</PhoneLink>\r\n            <PhoneLink to='/about'>关于我</PhoneLink>\r\n            {\r\n              UserStore.currentUser ? <>\r\n                {/* <div>{ UserStore.currentUser.attributes.username }</div> */}\r\n                <div className='danger' onClick={handleLogOut}>注销</div>\r\n              </>:\r\n              <>\r\n                <div onClick={handleLogIn}>登录</div>\r\n                <div onClick={handleRegister}>注册</div>\r\n              </>\r\n            }\r\n        </nav>\r\n        </HeaderBox>\r\n      }\r\n      \r\n    </Header>\r\n  )\r\n})\r\n\r\nexport default Component","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Footer = styled.footer`\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #aaa;\r\n  padding: 6px 10px;\r\n  background-color: rgba(255,255,255,.1);\r\n`\r\n\r\nfunction Component(){\r\n  return (\r\n    <Footer>\r\n      <div>请勿上传违反中国大陆和香港法律的图片，违者后果自负.</div>\r\n    </Footer>\r\n  )\r\n}\r\n\r\nexport default Component","import React from \"react\";\r\n\r\nfunction Loading(){\r\n  return (\r\n    <>\r\n      <div>loading...</div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Loading","import React, { Suspense } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Loading from \"./components/Loading\";\nimport { \n  Switch,\n  Route\n } from \"react-router-dom\";\n import 'antd/dist/antd.css';\n import './App.css';\n\nconst Home = React.lazy(()=>import('./pages/Home'));\nconst History = React.lazy(()=>import('./pages/History'));\nconst About = React.lazy(()=>import('./pages/About'));\nconst Login = React.lazy(()=>import('./pages/Login'));\nconst Register = React.lazy(()=>import('./pages/Register'));\n\n\n\n\nfunction App() {\n  return (\n    <>\n     <Header />\n\n     <main>\n     <Suspense fallback={ <Loading /> }>\n      <Switch>\n        <Route path='/' exact component={Home} />\n        <Route path='/history' component={History} />\n        <Route path='/about' component={About} />\n        <Route path='/login' component={Login} />\n        <Route path='/register' component={Register} />\n      </Switch>\n     </Suspense>\n     </main>\n\n     <Footer />\n    </>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { \n  HashRouter as Router\n } from \"react-router-dom\";\n\nReactDOM.render(\n  <React.StrictMode>\n\n    <Router>\n      <App />\n    </Router>\n    \n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import Avatar from \"antd/lib/avatar/avatar\";\r\nimport AV, { Query, User } from \"leancloud-storage\";\r\n\r\n\r\nAV.init({\r\n  appId: \"2kn3uNRmbJ020gk4UEYl2Gti-gzGzoHsz\",\r\n  appKey: \"quqhs0ykhyzpN2CXfWRTRnDW\",\r\n  serverURL: \"https://2kn3unrm.lc-cn-n1-shared.com\"\r\n});\r\n\r\n\r\n\r\nconst Auth = {\r\n  register(username, password){\r\n    let user = new User()\r\n    user.setUsername(username);\r\n    user.setPassword(password);\r\n    return new Promise((resolve, reject) => {\r\n      user.signUp().then( user => resolve(user), error => reject(error))\r\n    })\r\n  },\r\n\r\n  login(username, password){\r\n    return new Promise((resolve, reject)=>{\r\n      User.logIn(username, password).then(user => resolve(user), error=>reject(error))\r\n    })\r\n    \r\n  },\r\n\r\n  logOut(){\r\n    User.logOut();\r\n  },\r\n\r\n  getCurrentUser(){\r\n    return User.current()\r\n  }\r\n}\r\n\r\nconst Uploader = {\r\n  add(file, filename){\r\n    const image = new AV.Object('Image')\r\n    const avFile = new AV.File(filename, file)\r\n    image.set('filename', filename)\r\n    image.set('owner', User.current())\r\n    image.set('url', avFile)\r\n    return new Promise((resolve, reject) => {\r\n      image.save().then(serverFile => resolve(serverFile), error => reject(error))\r\n    })\r\n  },\r\n\r\n  find({page=0, limit=10}){\r\n    const query = new AV.Query('Image')\r\n    query.include('owner');\r\n    query.equalTo('owner', User.current());\r\n    query.limit(limit);\r\n    query.skip(limit*page);\r\n    query.descending('createdAt')\r\n    return new Promise((resolve, reject)=>{\r\n      query.find().then((results) => {\r\n        resolve(results)\r\n      }).catch(err => {\r\n        reject(err)\r\n      })\r\n    })\r\n  },\r\n\r\n  delete(fileId){\r\n    const file = AV.Object.createWithoutData('Image', fileId);\r\n    return new Promise((resolve, reject)=>{\r\n      file.destroy().then(result=>{\r\n        resolve(result)\r\n      }).catch(err=>{\r\n        reject(err)\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport {\r\n  Auth,\r\n  Uploader\r\n}","import { makeAutoObservable, observable, action } from \"mobx\";\r\nimport { Auth } from \"../models\";\r\n\r\nclass UserStore{\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n\r\n    this.pullUser()\r\n  }\r\n  @observable currentUser = null;\r\n\r\n  @action pullUser(){\r\n    this.currentUser = Auth.getCurrentUser()\r\n  }\r\n\r\n  @action resetUser(){\r\n    this.currentUser = null\r\n  }\r\n}\r\n\r\nexport default new UserStore()","import { message } from \"antd\";\r\nimport { makeAutoObservable, observable, action } from \"mobx\";\r\nimport { Uploader } from \"../models\";\r\n\r\nclass HistoryStore{\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n  }\r\n  @observable list = [];\r\n  @observable isLoading = false;\r\n  @observable hasMore = true;\r\n  @observable page = 0;\r\n  limit = 10;\r\n\r\n  @action append(newList){\r\n    this.list = this.list.concat(newList)\r\n  }\r\n\r\n  @action find(){\r\n    this.isLoading = true\r\n    Uploader.find({page: this.page, limit: this.limit}).then(newList => {\r\n      this.append(newList)\r\n      this.page++\r\n      if(newList.length < this.limit){\r\n        this.hasMore = false\r\n      }\r\n    }).catch(err => {\r\n      message.error('加载数据失败！')\r\n    }).finally(() => {\r\n      this.isLoading = false\r\n    })\r\n  }\r\n\r\n  @action delete(fileId){\r\n    Uploader.delete(fileId).then(result => {\r\n      message.success('删除成功')\r\n      this.list = this.list.filter(item => item.id !== fileId)\r\n      // this.list = this.list.splice(this.list.indexOf(this.list.filter(item => item.id == fileId)[0]),1)\r\n    }).catch(err => {\r\n      message.error('删除失败')\r\n    })\r\n  }\r\n\r\n  @action reset(){\r\n    this.list = [];\r\n    this.isLoading = false;\r\n    this.hasMore = true;\r\n    this.page = 0;\r\n  }\r\n}\r\n\r\nexport default new HistoryStore()","import { makeAutoObservable, observable, action } from \"mobx\";\r\nimport { Uploader } from \"../models\";\r\nimport { message } from \"antd\";\r\n\r\nclass ImageStore{\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n  }\r\n  @observable filename = '';\r\n  @observable file = null;\r\n  @observable isUploading = false;\r\n  @observable serverFile = null;\r\n\r\n  @action setFilename(filename){\r\n    this.filename = filename\r\n  }\r\n\r\n  @action setFile(file){\r\n    this.file = file\r\n  }\r\n\r\n  @action upload(){\r\n    this.isUploading = true\r\n    this.serverFile = null\r\n    return new Promise((resolve, reject)=>{\r\n      Uploader.add(this.file, this.filename).then(serverFile=>{\r\n        this.serverFile = serverFile\r\n        resolve(serverFile)\r\n      }).catch(err =>{\r\n        reject(err)\r\n        message.error('上传失败！')\r\n      }).finally(()=>{\r\n        this.isUploading = false\r\n      })\r\n    })\r\n  }\r\n\r\n  @action reset(){\r\n    this.serverFile = null;\r\n    this.isUploading = false;\r\n  }\r\n}\r\n\r\nexport default new ImageStore()","//维护所有登录注册有关的行为和状态 \r\nimport { makeAutoObservable, observable, action } from \"mobx\";\r\nimport { Auth } from \"../models\";\r\nimport UserStore from \"./user\";\r\nimport HistoryStore from \"./history\";\r\nimport ImageStore from \"./image\";\r\nimport { message } from \"antd\";\r\n\r\nclass AuthStore{\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n}\r\n\r\n  @observable values = {\r\n    username: '',\r\n    password: ''\r\n  }\r\n\r\n  @action setUsername(username){\r\n    this.values.username = username\r\n  }\r\n\r\n  @action setPassword(password){\r\n    this.values.password = password\r\n  }\r\n\r\n  @action login(){\r\n    return new Promise((resolve, reject)=>{\r\n      Auth.login(this.values.username, this.values.password)\r\n        .then(user=> {\r\n          UserStore.pullUser()\r\n          resolve(user)\r\n        }).catch(error=> {\r\n          UserStore.resetUser()\r\n          switch (error.code) {\r\n            case -1:\r\n              message.error('请求已终止，请查看网络连接')\r\n              break;\r\n            case 210:\r\n              message.error('用户名或密码错误')\r\n            break;\r\n            case 211:\r\n              message.error('用户不存在')\r\n            break;\r\n            case 219:\r\n              message.error('登录失败次数超过限制，请稍候再试，或者通过忘记密码重设密码。')\r\n            break;\r\n            default:\r\n              break;\r\n          }\r\n          reject(error)\r\n        })\r\n    })\r\n  }\r\n\r\n  @action register(){\r\n    return new Promise((resolve, reject)=>{\r\n      Auth.register(this.values.username, this.values.password)\r\n    .then(user=> {\r\n      UserStore.pullUser()\r\n      resolve(user)\r\n    })\r\n    .catch(error=> {\r\n      UserStore.resetUser()\r\n      switch (error.code) {\r\n        case -1:\r\n          message.error('请求已终止，请查看网络连接')\r\n          break;\r\n        case 202:\r\n          message.error('用户名已存在')\r\n        break;\r\n        \r\n        default:\r\n          break;\r\n      }\r\n      reject(error)\r\n    })\r\n    })\r\n  }\r\n\r\n  @action logOut(){\r\n    Auth.logOut()\r\n    UserStore.resetUser()\r\n    HistoryStore.reset()\r\n    ImageStore.reset()\r\n  }\r\n}\r\n\r\nexport default new AuthStore()","import React, { createContext, useContext } from \"react\";\r\nimport AuthStore from \"./auth\";\r\nimport UserStore from \"./user\";\r\nimport ImageStore from \"./image\";\r\nimport HistoryStore from \"./history\";\r\n\r\nconst context = createContext({\r\n  AuthStore,\r\n  UserStore,\r\n  ImageStore,\r\n  HistoryStore\r\n})\r\n\r\nwindow.stores= {\r\n  AuthStore,\r\n  UserStore,\r\n  ImageStore,\r\n  HistoryStore\r\n}\r\n\r\nexport const useStores = () => useContext(context);"],"sourceRoot":""}